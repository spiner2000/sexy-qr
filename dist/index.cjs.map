{"version":3,"file":"index.cjs","sources":["../src/QR8bitByte.ts","../src/QRMode.ts","../src/QRErrorCorrectLevel.ts","../src/QRRSBlock.ts","../src/QRBitBuffer.ts","../src/QRMath.ts","../src/QRPolynomial.ts","../src/QRUtil.ts","../src/QRMaskPattern.ts","../src/QRCodeModel.ts","../src/QRCodeLimitLength.ts","../src/utils.ts","../src/QRCode.ts","../src/QRSvg.ts"],"sourcesContent":["import { QRMode } from './QRMode';\r\n\r\nexport class QR8bitByte {\r\n  mode = QRMode.MODE_8BIT_BYTE;\r\n\r\n  data: string;\r\n\r\n  parsedData: (number[] | number)[] = [];\r\n\r\n  constructor(data) {\r\n    this.data = data;\r\n\r\n    // Added to support UTF-8 Characters\r\n    let i = 0;\r\n    const l = this.data.length;\r\n    for (; i < l; i++) {\r\n      const code = this.data.charCodeAt(i);\r\n\r\n      let byteArray: number[];\r\n      if (code > 0x10000) {\r\n        // prettier-ignore\r\n        byteArray = [\r\n          0xf0 | ((code & 0x1c0000) >>> 18),\r\n          0x80 | ((code & 0x3f000) >>> 12),\r\n          0x80 | ((code & 0xfc0) >>> 6),\r\n          0x80 | (code & 0x3f),\r\n        ];\r\n      } else if (code > 0x800) {\r\n        // prettier-ignore\r\n        byteArray = [\r\n          0xe0 | ((code & 0xf000) >>> 12),\r\n          0x80 | ((code & 0xfc0) >>> 6),\r\n          0x80 | (code & 0x3f),\r\n        ]\r\n      } else if (code > 0x80) {\r\n        // prettier-ignore\r\n        byteArray = [\r\n          0xc0 | ((code & 0x7c0) >>> 6),\r\n          0x80 | (code & 0x3f),\r\n        ]\r\n      } else {\r\n        byteArray = [code];\r\n      }\r\n\r\n      this.parsedData.push(byteArray);\r\n    }\r\n\r\n    this.parsedData = Array.prototype.concat.apply([], this.parsedData);\r\n\r\n    if (this.parsedData.length !== this.data.length) {\r\n      this.parsedData.unshift(191);\r\n      this.parsedData.unshift(187);\r\n      this.parsedData.unshift(239);\r\n    }\r\n  }\r\n\r\n  getLength() {\r\n    return this.parsedData.length;\r\n  }\r\n\r\n  write(buffer) {\r\n    let i = 0;\r\n    const l = this.parsedData.length;\r\n    for (; i < l; i++) {\r\n      buffer.put(this.parsedData[i], 8);\r\n    }\r\n  }\r\n}\r\n","export const QRMode = {\r\n  MODE_NUMBER: 1 << 0,\r\n  MODE_ALPHA_NUM: 1 << 1,\r\n  MODE_8BIT_BYTE: 1 << 2,\r\n  MODE_KANJI: 1 << 3,\r\n};\r\n\r\nexport type QRMode = typeof QRMode[keyof typeof QRMode];\r\n","export const QRErrorCorrectLevel = {\r\n  L: 1,\r\n  M: 0,\r\n  Q: 3,\r\n  H: 2,\r\n};\r\n\r\nexport type QRErrorCorrectLevel = typeof QRErrorCorrectLevel[keyof typeof QRErrorCorrectLevel];\r\n","import { QRErrorCorrectLevel } from './QRErrorCorrectLevel';\r\n\r\nexport class QRRSBlock {\r\n  totalCount!: number;\r\n  dataCount!: number;\r\n\r\n  constructor(totalCount, dataCount) {\r\n    this.totalCount = totalCount;\r\n    this.dataCount = dataCount;\r\n  }\r\n\r\n  static RS_BLOCK_TABLE = [\r\n    [1, 26, 19],\r\n    [1, 26, 16],\r\n    [1, 26, 13],\r\n    [1, 26, 9],\r\n    [1, 44, 34],\r\n    [1, 44, 28],\r\n    [1, 44, 22],\r\n    [1, 44, 16],\r\n    [1, 70, 55],\r\n    [1, 70, 44],\r\n    [2, 35, 17],\r\n    [2, 35, 13],\r\n    [1, 100, 80],\r\n    [2, 50, 32],\r\n    [2, 50, 24],\r\n    [4, 25, 9],\r\n    [1, 134, 108],\r\n    [2, 67, 43],\r\n    [2, 33, 15, 2, 34, 16],\r\n    [2, 33, 11, 2, 34, 12],\r\n    [2, 86, 68],\r\n    [4, 43, 27],\r\n    [4, 43, 19],\r\n    [4, 43, 15],\r\n    [2, 98, 78],\r\n    [4, 49, 31],\r\n    [2, 32, 14, 4, 33, 15],\r\n    [4, 39, 13, 1, 40, 14],\r\n    [2, 121, 97],\r\n    [2, 60, 38, 2, 61, 39],\r\n    [4, 40, 18, 2, 41, 19],\r\n    [4, 40, 14, 2, 41, 15],\r\n    [2, 146, 116],\r\n    [3, 58, 36, 2, 59, 37],\r\n    [4, 36, 16, 4, 37, 17],\r\n    [4, 36, 12, 4, 37, 13],\r\n    [2, 86, 68, 2, 87, 69],\r\n    [4, 69, 43, 1, 70, 44],\r\n    [6, 43, 19, 2, 44, 20],\r\n    [6, 43, 15, 2, 44, 16],\r\n    [4, 101, 81],\r\n    [1, 80, 50, 4, 81, 51],\r\n    [4, 50, 22, 4, 51, 23],\r\n    [3, 36, 12, 8, 37, 13],\r\n    [2, 116, 92, 2, 117, 93],\r\n    [6, 58, 36, 2, 59, 37],\r\n    [4, 46, 20, 6, 47, 21],\r\n    [7, 42, 14, 4, 43, 15],\r\n    [4, 133, 107],\r\n    [8, 59, 37, 1, 60, 38],\r\n    [8, 44, 20, 4, 45, 21],\r\n    [12, 33, 11, 4, 34, 12],\r\n    [3, 145, 115, 1, 146, 116],\r\n    [4, 64, 40, 5, 65, 41],\r\n    [11, 36, 16, 5, 37, 17],\r\n    [11, 36, 12, 5, 37, 13],\r\n    [5, 109, 87, 1, 110, 88],\r\n    [5, 65, 41, 5, 66, 42],\r\n    [5, 54, 24, 7, 55, 25],\r\n    [11, 36, 12],\r\n    [5, 122, 98, 1, 123, 99],\r\n    [7, 73, 45, 3, 74, 46],\r\n    [15, 43, 19, 2, 44, 20],\r\n    [3, 45, 15, 13, 46, 16],\r\n    [1, 135, 107, 5, 136, 108],\r\n    [10, 74, 46, 1, 75, 47],\r\n    [1, 50, 22, 15, 51, 23],\r\n    [2, 42, 14, 17, 43, 15],\r\n    [5, 150, 120, 1, 151, 121],\r\n    [9, 69, 43, 4, 70, 44],\r\n    [17, 50, 22, 1, 51, 23],\r\n    [2, 42, 14, 19, 43, 15],\r\n    [3, 141, 113, 4, 142, 114],\r\n    [3, 70, 44, 11, 71, 45],\r\n    [17, 47, 21, 4, 48, 22],\r\n    [9, 39, 13, 16, 40, 14],\r\n    [3, 135, 107, 5, 136, 108],\r\n    [3, 67, 41, 13, 68, 42],\r\n    [15, 54, 24, 5, 55, 25],\r\n    [15, 43, 15, 10, 44, 16],\r\n    [4, 144, 116, 4, 145, 117],\r\n    [17, 68, 42],\r\n    [17, 50, 22, 6, 51, 23],\r\n    [19, 46, 16, 6, 47, 17],\r\n    [2, 139, 111, 7, 140, 112],\r\n    [17, 74, 46],\r\n    [7, 54, 24, 16, 55, 25],\r\n    [34, 37, 13],\r\n    [4, 151, 121, 5, 152, 122],\r\n    [4, 75, 47, 14, 76, 48],\r\n    [11, 54, 24, 14, 55, 25],\r\n    [16, 45, 15, 14, 46, 16],\r\n    [6, 147, 117, 4, 148, 118],\r\n    [6, 73, 45, 14, 74, 46],\r\n    [11, 54, 24, 16, 55, 25],\r\n    [30, 46, 16, 2, 47, 17],\r\n    [8, 132, 106, 4, 133, 107],\r\n    [8, 75, 47, 13, 76, 48],\r\n    [7, 54, 24, 22, 55, 25],\r\n    [22, 45, 15, 13, 46, 16],\r\n    [10, 142, 114, 2, 143, 115],\r\n    [19, 74, 46, 4, 75, 47],\r\n    [28, 50, 22, 6, 51, 23],\r\n    [33, 46, 16, 4, 47, 17],\r\n    [8, 152, 122, 4, 153, 123],\r\n    [22, 73, 45, 3, 74, 46],\r\n    [8, 53, 23, 26, 54, 24],\r\n    [12, 45, 15, 28, 46, 16],\r\n    [3, 147, 117, 10, 148, 118],\r\n    [3, 73, 45, 23, 74, 46],\r\n    [4, 54, 24, 31, 55, 25],\r\n    [11, 45, 15, 31, 46, 16],\r\n    [7, 146, 116, 7, 147, 117],\r\n    [21, 73, 45, 7, 74, 46],\r\n    [1, 53, 23, 37, 54, 24],\r\n    [19, 45, 15, 26, 46, 16],\r\n    [5, 145, 115, 10, 146, 116],\r\n    [19, 75, 47, 10, 76, 48],\r\n    [15, 54, 24, 25, 55, 25],\r\n    [23, 45, 15, 25, 46, 16],\r\n    [13, 145, 115, 3, 146, 116],\r\n    [2, 74, 46, 29, 75, 47],\r\n    [42, 54, 24, 1, 55, 25],\r\n    [23, 45, 15, 28, 46, 16],\r\n    [17, 145, 115],\r\n    [10, 74, 46, 23, 75, 47],\r\n    [10, 54, 24, 35, 55, 25],\r\n    [19, 45, 15, 35, 46, 16],\r\n    [17, 145, 115, 1, 146, 116],\r\n    [14, 74, 46, 21, 75, 47],\r\n    [29, 54, 24, 19, 55, 25],\r\n    [11, 45, 15, 46, 46, 16],\r\n    [13, 145, 115, 6, 146, 116],\r\n    [14, 74, 46, 23, 75, 47],\r\n    [44, 54, 24, 7, 55, 25],\r\n    [59, 46, 16, 1, 47, 17],\r\n    [12, 151, 121, 7, 152, 122],\r\n    [12, 75, 47, 26, 76, 48],\r\n    [39, 54, 24, 14, 55, 25],\r\n    [22, 45, 15, 41, 46, 16],\r\n    [6, 151, 121, 14, 152, 122],\r\n    [6, 75, 47, 34, 76, 48],\r\n    [46, 54, 24, 10, 55, 25],\r\n    [2, 45, 15, 64, 46, 16],\r\n    [17, 152, 122, 4, 153, 123],\r\n    [29, 74, 46, 14, 75, 47],\r\n    [49, 54, 24, 10, 55, 25],\r\n    [24, 45, 15, 46, 46, 16],\r\n    [4, 152, 122, 18, 153, 123],\r\n    [13, 74, 46, 32, 75, 47],\r\n    [48, 54, 24, 14, 55, 25],\r\n    [42, 45, 15, 32, 46, 16],\r\n    [20, 147, 117, 4, 148, 118],\r\n    [40, 75, 47, 7, 76, 48],\r\n    [43, 54, 24, 22, 55, 25],\r\n    [10, 45, 15, 67, 46, 16],\r\n    [19, 148, 118, 6, 149, 119],\r\n    [18, 75, 47, 31, 76, 48],\r\n    [34, 54, 24, 34, 55, 25],\r\n    [20, 45, 15, 61, 46, 16],\r\n  ];\r\n\r\n  static getRSBlocks(typeNumber, errorCorrectLevel) {\r\n    const rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);\r\n    if (rsBlock === undefined) {\r\n      throw new Error('bad rs block @ typeNumber:' + typeNumber + '/errorCorrectLevel:' + errorCorrectLevel);\r\n    }\r\n    const length = rsBlock.length / 3;\r\n    const list: QRRSBlock[] = [];\r\n    for (let i = 0; i < length; i++) {\r\n      const count = rsBlock[i * 3];\r\n      const totalCount = rsBlock[i * 3 + 1];\r\n      const dataCount = rsBlock[i * 3 + 2];\r\n      for (let j = 0; j < count; j++) {\r\n        list.push(new QRRSBlock(totalCount, dataCount));\r\n      }\r\n    }\r\n    return list;\r\n  }\r\n\r\n  static getRsBlockTable(typeNumber, errorCorrectLevel) {\r\n    switch (errorCorrectLevel) {\r\n      case QRErrorCorrectLevel.L:\r\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4];\r\n      case QRErrorCorrectLevel.M:\r\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\r\n      case QRErrorCorrectLevel.Q:\r\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\r\n      case QRErrorCorrectLevel.H:\r\n        return QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\r\n      default:\r\n        return undefined;\r\n    }\r\n  }\r\n}\r\n","export class QRBitBuffer {\r\n  buffer: number[] = [];\r\n\r\n  length = 0;\r\n\r\n  constructor() {}\r\n\r\n  get(index) {\r\n    const bufIndex = Math.floor(index / 8);\r\n    return ((this.buffer[bufIndex] >>> (7 - (index % 8))) & 1) === 1;\r\n  }\r\n\r\n  put(num, length) {\r\n    for (let i = 0; i < length; i++) {\r\n      this.putBit(((num >>> (length - i - 1)) & 1) === 1);\r\n    }\r\n  }\r\n\r\n  getLengthInBits() {\r\n    return this.length;\r\n  }\r\n\r\n  putBit(bit) {\r\n    const bufIndex = Math.floor(this.length / 8);\r\n    if (this.buffer.length <= bufIndex) {\r\n      this.buffer.push(0);\r\n    }\r\n    if (bit) {\r\n      this.buffer[bufIndex] |= 0x80 >>> this.length % 8;\r\n    }\r\n    this.length++;\r\n  }\r\n}\r\n","export const [EXP_TABLE, LOG_TABLE] = (() => {\r\n  const EXP_TABLE = new Array(256);\r\n  const LOG_TABLE = new Array(256);\r\n\r\n  for (let i = 0; i < 8; i++) {\r\n    EXP_TABLE[i] = 1 << i;\r\n  }\r\n  for (let i = 8; i < 256; i++) {\r\n    EXP_TABLE[i] = EXP_TABLE[i - 4] ^ EXP_TABLE[i - 5] ^ EXP_TABLE[i - 6] ^ EXP_TABLE[i - 8];\r\n  }\r\n  for (let i = 0; i < 255; i++) {\r\n    LOG_TABLE[EXP_TABLE[i]] = i;\r\n  }\r\n\r\n  return [EXP_TABLE, LOG_TABLE];\r\n})();\r\n\r\nexport const glog = (n) => {\r\n  if (n < 1) {\r\n    throw new Error('glog(' + n + ')');\r\n  }\r\n  return LOG_TABLE[n];\r\n};\r\n\r\nexport const gexp = (n) => {\r\n  while (n < 0) {\r\n    n += 255;\r\n  }\r\n  while (n >= 256) {\r\n    n -= 255;\r\n  }\r\n  return EXP_TABLE[n];\r\n};\r\n","import * as QRMath from './QRMath';\r\n\r\nexport class QRPolynomial {\r\n  num: number[];\r\n\r\n  constructor(num, shift) {\r\n    if (num.length === undefined) {\r\n      throw new Error(num.length + '/' + shift);\r\n    }\r\n    let offset = 0;\r\n    while (offset < num.length && num[offset] === 0) {\r\n      offset++;\r\n    }\r\n    this.num = new Array(num.length - offset + shift);\r\n    for (let i = 0; i < num.length - offset; i++) {\r\n      this.num[i] = num[i + offset];\r\n    }\r\n  }\r\n\r\n  get(index) {\r\n    return this.num[index];\r\n  }\r\n\r\n  getLength() {\r\n    return this.num.length;\r\n  }\r\n\r\n  multiply(e) {\r\n    const num = new Array(this.getLength() + e.getLength() - 1);\r\n    for (let i = 0; i < this.getLength(); i++) {\r\n      for (let j = 0; j < e.getLength(); j++) {\r\n        num[i + j] ^= QRMath.gexp(QRMath.glog(this.get(i)) + QRMath.glog(e.get(j)));\r\n      }\r\n    }\r\n    return new QRPolynomial(num, 0);\r\n  }\r\n\r\n  mod(e) {\r\n    if (this.getLength() - e.getLength() < 0) {\r\n      return this;\r\n    }\r\n    const ratio = QRMath.glog(this.get(0)) - QRMath.glog(e.get(0));\r\n    const num = new Array(this.getLength());\r\n    for (let i = 0; i < this.getLength(); i++) {\r\n      num[i] = this.get(i);\r\n    }\r\n    for (let i = 0; i < e.getLength(); i++) {\r\n      num[i] ^= QRMath.gexp(QRMath.glog(e.get(i)) + ratio);\r\n    }\r\n    return new QRPolynomial(num, 0).mod(e);\r\n  }\r\n}\r\n","import { QRMaskPattern } from './QRMaskPattern';\r\nimport { QRPolynomial } from './QRPolynomial';\r\nimport { QRMode } from './QRMode';\r\nimport * as QRMath from './QRMath';\r\n\r\nexport const PATTERN_POSITION_TABLE = [\r\n  [],\r\n  [6, 18],\r\n  [6, 22],\r\n  [6, 26],\r\n  [6, 30],\r\n  [6, 34],\r\n  [6, 22, 38],\r\n  [6, 24, 42],\r\n  [6, 26, 46],\r\n  [6, 28, 50],\r\n  [6, 30, 54],\r\n  [6, 32, 58],\r\n  [6, 34, 62],\r\n  [6, 26, 46, 66],\r\n  [6, 26, 48, 70],\r\n  [6, 26, 50, 74],\r\n  [6, 30, 54, 78],\r\n  [6, 30, 56, 82],\r\n  [6, 30, 58, 86],\r\n  [6, 34, 62, 90],\r\n  [6, 28, 50, 72, 94],\r\n  [6, 26, 50, 74, 98],\r\n  [6, 30, 54, 78, 102],\r\n  [6, 28, 54, 80, 106],\r\n  [6, 32, 58, 84, 110],\r\n  [6, 30, 58, 86, 114],\r\n  [6, 34, 62, 90, 118],\r\n  [6, 26, 50, 74, 98, 122],\r\n  [6, 30, 54, 78, 102, 126],\r\n  [6, 26, 52, 78, 104, 130],\r\n  [6, 30, 56, 82, 108, 134],\r\n  [6, 34, 60, 86, 112, 138],\r\n  [6, 30, 58, 86, 114, 142],\r\n  [6, 34, 62, 90, 118, 146],\r\n  [6, 30, 54, 78, 102, 126, 150],\r\n  [6, 24, 50, 76, 102, 128, 154],\r\n  [6, 28, 54, 80, 106, 132, 158],\r\n  [6, 32, 58, 84, 110, 136, 162],\r\n  [6, 26, 54, 82, 110, 138, 166],\r\n  [6, 30, 58, 86, 114, 142, 170],\r\n];\r\n\r\nexport const G15 = (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0);\r\n\r\nexport const G18 = (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0);\r\n\r\nexport const G15_MASK = (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1);\r\n\r\nexport const getBCHDigit = (data) => {\r\n  let digit = 0;\r\n  while (data !== 0) {\r\n    digit++;\r\n    data >>>= 1;\r\n  }\r\n  return digit;\r\n};\r\n\r\nexport const getBCHTypeInfo = (data) => {\r\n  let d = data << 10;\r\n  while (getBCHDigit(d) - getBCHDigit(G15) >= 0) {\r\n    d ^= G15 << (getBCHDigit(d) - getBCHDigit(G15));\r\n  }\r\n  return ((data << 10) | d) ^ G15_MASK;\r\n};\r\n\r\nexport const getBCHTypeNumber = (data) => {\r\n  let d = data << 12;\r\n  while (getBCHDigit(d) - getBCHDigit(G18) >= 0) {\r\n    d ^= G18 << (getBCHDigit(d) - getBCHDigit(G18));\r\n  }\r\n  return (data << 12) | d;\r\n};\r\n\r\nexport const getPatternPosition = (typeNumber) => {\r\n  return PATTERN_POSITION_TABLE[typeNumber - 1];\r\n};\r\n\r\nexport const getMask = (maskPattern, i, j) => {\r\n  switch (maskPattern) {\r\n    case QRMaskPattern.PATTERN000:\r\n      return (i + j) % 2 === 0;\r\n    case QRMaskPattern.PATTERN001:\r\n      return i % 2 === 0;\r\n    case QRMaskPattern.PATTERN010:\r\n      return j % 3 === 0;\r\n    case QRMaskPattern.PATTERN011:\r\n      return (i + j) % 3 === 0;\r\n    case QRMaskPattern.PATTERN100:\r\n      return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 === 0;\r\n    case QRMaskPattern.PATTERN101:\r\n      return ((i * j) % 2) + ((i * j) % 3) === 0;\r\n    case QRMaskPattern.PATTERN110:\r\n      return (((i * j) % 2) + ((i * j) % 3)) % 2 === 0;\r\n    case QRMaskPattern.PATTERN111:\r\n      return (((i * j) % 3) + ((i + j) % 2)) % 2 === 0;\r\n    default:\r\n      throw new Error('bad maskPattern:' + maskPattern);\r\n  }\r\n};\r\n\r\nexport const getErrorCorrectPolynomial = (errorCorrectLength) => {\r\n  let a = new QRPolynomial([1], 0);\r\n  for (let i = 0; i < errorCorrectLength; i++) {\r\n    a = a.multiply(new QRPolynomial([1, QRMath.gexp(i)], 0));\r\n  }\r\n  return a;\r\n};\r\n\r\nexport const getLengthInBits = (mode, type) => {\r\n  if (1 <= type && type < 10) {\r\n    switch (mode) {\r\n      case QRMode.MODE_NUMBER:\r\n        return 10;\r\n      case QRMode.MODE_ALPHA_NUM:\r\n        return 9;\r\n      case QRMode.MODE_8BIT_BYTE:\r\n        return 8;\r\n      case QRMode.MODE_KANJI:\r\n        return 8;\r\n      default:\r\n        throw new Error('mode:' + mode);\r\n    }\r\n  } else if (type < 27) {\r\n    switch (mode) {\r\n      case QRMode.MODE_NUMBER:\r\n        return 12;\r\n      case QRMode.MODE_ALPHA_NUM:\r\n        return 11;\r\n      case QRMode.MODE_8BIT_BYTE:\r\n        return 16;\r\n      case QRMode.MODE_KANJI:\r\n        return 10;\r\n      default:\r\n        throw new Error('mode:' + mode);\r\n    }\r\n  } else if (type < 41) {\r\n    switch (mode) {\r\n      case QRMode.MODE_NUMBER:\r\n        return 14;\r\n      case QRMode.MODE_ALPHA_NUM:\r\n        return 13;\r\n      case QRMode.MODE_8BIT_BYTE:\r\n        return 16;\r\n      case QRMode.MODE_KANJI:\r\n        return 12;\r\n      default:\r\n        throw new Error('mode:' + mode);\r\n    }\r\n  } else {\r\n    throw new Error('type:' + type);\r\n  }\r\n};\r\n\r\nexport const getLostPoint = (qrCode) => {\r\n  const moduleCount = qrCode.getModuleCount();\r\n  let lostPoint = 0;\r\n  for (let row = 0; row < moduleCount; row++) {\r\n    for (let col = 0; col < moduleCount; col++) {\r\n      let sameCount = 0;\r\n      const dark = qrCode.isDark(row, col);\r\n      for (let r = -1; r <= 1; r++) {\r\n        if (row + r < 0 || moduleCount <= row + r) {\r\n          continue;\r\n        }\r\n        for (let c = -1; c <= 1; c++) {\r\n          if (col + c < 0 || moduleCount <= col + c) {\r\n            continue;\r\n          }\r\n          if (r === 0 && c === 0) {\r\n            continue;\r\n          }\r\n          if (dark === qrCode.isDark(row + r, col + c)) {\r\n            sameCount++;\r\n          }\r\n        }\r\n      }\r\n      if (sameCount > 5) {\r\n        lostPoint += 3 + sameCount - 5;\r\n      }\r\n    }\r\n  }\r\n  for (let row = 0; row < moduleCount - 1; row++) {\r\n    for (let col = 0; col < moduleCount - 1; col++) {\r\n      let count = 0;\r\n      if (qrCode.isDark(row, col)) count++;\r\n      if (qrCode.isDark(row + 1, col)) count++;\r\n      if (qrCode.isDark(row, col + 1)) count++;\r\n      if (qrCode.isDark(row + 1, col + 1)) count++;\r\n      if (count === 0 || count === 4) {\r\n        lostPoint += 3;\r\n      }\r\n    }\r\n  }\r\n  for (let row = 0; row < moduleCount; row++) {\r\n    for (let col = 0; col < moduleCount - 6; col++) {\r\n      if (\r\n        qrCode.isDark(row, col) &&\r\n        !qrCode.isDark(row, col + 1) &&\r\n        qrCode.isDark(row, col + 2) &&\r\n        qrCode.isDark(row, col + 3) &&\r\n        qrCode.isDark(row, col + 4) &&\r\n        !qrCode.isDark(row, col + 5) &&\r\n        qrCode.isDark(row, col + 6)\r\n      ) {\r\n        lostPoint += 40;\r\n      }\r\n    }\r\n  }\r\n  for (let col = 0; col < moduleCount; col++) {\r\n    for (let row = 0; row < moduleCount - 6; row++) {\r\n      if (\r\n        qrCode.isDark(row, col) &&\r\n        !qrCode.isDark(row + 1, col) &&\r\n        qrCode.isDark(row + 2, col) &&\r\n        qrCode.isDark(row + 3, col) &&\r\n        qrCode.isDark(row + 4, col) &&\r\n        !qrCode.isDark(row + 5, col) &&\r\n        qrCode.isDark(row + 6, col)\r\n      ) {\r\n        lostPoint += 40;\r\n      }\r\n    }\r\n  }\r\n  let darkCount = 0;\r\n  for (let col = 0; col < moduleCount; col++) {\r\n    for (let row = 0; row < moduleCount; row++) {\r\n      if (qrCode.isDark(row, col)) {\r\n        darkCount++;\r\n      }\r\n    }\r\n  }\r\n  const ratio = Math.abs((100 * darkCount) / moduleCount / moduleCount - 50) / 5;\r\n  lostPoint += ratio * 10;\r\n  return lostPoint;\r\n};\r\n","export const QRMaskPattern = {\r\n  PATTERN000: 0,\r\n  PATTERN001: 1,\r\n  PATTERN010: 2,\r\n  PATTERN011: 3,\r\n  PATTERN100: 4,\r\n  PATTERN101: 5,\r\n  PATTERN110: 6,\r\n  PATTERN111: 7,\r\n};\r\n\r\nexport type QRMaskPattern = typeof QRMaskPattern[keyof typeof QRMaskPattern];\r\n","import { QR8bitByte } from './QR8bitByte';\r\nimport { QRRSBlock } from './QRRSBlock';\r\nimport { QRBitBuffer } from './QRBitBuffer';\r\nimport { QRPolynomial } from './QRPolynomial';\r\nimport * as QRUtil from './QRUtil';\r\n\r\nconst PAD0 = 0xec;\r\nconst PAD1 = 0x11;\r\n\r\nexport class QRCodeModel {\r\n  typeNumber!: number;\r\n  errorCorrectLevel!: number;\r\n  modules: (boolean | null)[][] = [];\r\n  moduleCount = 0;\r\n  dataCache: number[] | null = null;\r\n  dataList: QR8bitByte[] = [];\r\n\r\n  constructor(typeNumber, errorCorrectLevel) {\r\n    this.typeNumber = typeNumber;\r\n    this.errorCorrectLevel = errorCorrectLevel;\r\n  }\r\n\r\n  addData(data) {\r\n    const newData = new QR8bitByte(data);\r\n    this.dataList.push(newData);\r\n    this.dataCache = null;\r\n  }\r\n\r\n  isDark(row, col) {\r\n    if (row < 0 || this.moduleCount <= row || col < 0 || this.moduleCount <= col) {\r\n      throw new Error(row + ',' + col);\r\n    }\r\n    return this.modules[row][col];\r\n  }\r\n\r\n  getModuleCount() {\r\n    return this.moduleCount;\r\n  }\r\n\r\n  make() {\r\n    this.makeImpl(false, this.getBestMaskPattern());\r\n  }\r\n\r\n  makeImpl(test, maskPattern) {\r\n    this.moduleCount = this.typeNumber * 4 + 17;\r\n    this.modules = new Array(this.moduleCount);\r\n    for (let row = 0; row < this.moduleCount; row++) {\r\n      this.modules[row] = new Array(this.moduleCount);\r\n      for (let col = 0; col < this.moduleCount; col++) {\r\n        this.modules[row][col] = null;\r\n      }\r\n    }\r\n    this.setupPositionProbePattern(0, 0);\r\n    this.setupPositionProbePattern(this.moduleCount - 7, 0);\r\n    this.setupPositionProbePattern(0, this.moduleCount - 7);\r\n    this.setupPositionAdjustPattern();\r\n    this.setupTimingPattern();\r\n    this.setupTypeInfo(test, maskPattern);\r\n    if (this.typeNumber >= 7) {\r\n      this.setupTypeNumber(test);\r\n    }\r\n    if (this.dataCache == null) {\r\n      this.dataCache = this.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);\r\n    }\r\n    this.mapData(this.dataCache, maskPattern);\r\n  }\r\n\r\n  setupPositionProbePattern(row, col) {\r\n    for (let r = -1; r <= 7; r++) {\r\n      if (row + r <= -1 || this.moduleCount <= row + r) continue;\r\n      for (let c = -1; c <= 7; c++) {\r\n        if (col + c <= -1 || this.moduleCount <= col + c) continue;\r\n        this.modules[row + r][col + c] =\r\n          (0 <= r && r <= 6 && (c === 0 || c === 6)) ||\r\n          (0 <= c && c <= 6 && (r === 0 || r === 6)) ||\r\n          (2 <= r && r <= 4 && 2 <= c && c <= 4);\r\n      }\r\n    }\r\n  }\r\n\r\n  getBestMaskPattern() {\r\n    let minLostPoint = 0;\r\n    let pattern = 0;\r\n    for (let i = 0; i < 8; i++) {\r\n      this.makeImpl(true, i);\r\n      const lostPoint = QRUtil.getLostPoint(this);\r\n      if (i === 0 || minLostPoint > lostPoint) {\r\n        minLostPoint = lostPoint;\r\n        pattern = i;\r\n      }\r\n    }\r\n    return pattern;\r\n  }\r\n\r\n  createMovieClip(target_mc, instance_name, depth) {\r\n    const qr_mc = target_mc.createEmptyMovieClip(instance_name, depth);\r\n    const cs = 1;\r\n    this.make();\r\n    for (let row = 0; row < this.modules.length; row++) {\r\n      const y = row * cs;\r\n      for (let col = 0; col < this.modules[row].length; col++) {\r\n        const x = col * cs;\r\n        const dark = this.modules[row][col];\r\n        if (dark) {\r\n          qr_mc.beginFill(0, 100);\r\n          qr_mc.moveTo(x, y);\r\n          qr_mc.lineTo(x + cs, y);\r\n          qr_mc.lineTo(x + cs, y + cs);\r\n          qr_mc.lineTo(x, y + cs);\r\n          qr_mc.endFill();\r\n        }\r\n      }\r\n    }\r\n    return qr_mc;\r\n  }\r\n\r\n  setupTimingPattern() {\r\n    for (let r = 8; r < this.moduleCount - 8; r++) {\r\n      if (this.modules[r][6] != null) {\r\n        continue;\r\n      }\r\n      this.modules[r][6] = r % 2 === 0;\r\n    }\r\n    for (let c = 8; c < this.moduleCount - 8; c++) {\r\n      if (this.modules[6][c] != null) {\r\n        continue;\r\n      }\r\n      this.modules[6][c] = c % 2 === 0;\r\n    }\r\n  }\r\n\r\n  setupPositionAdjustPattern() {\r\n    const pos = QRUtil.getPatternPosition(this.typeNumber);\r\n    for (let i = 0; i < pos.length; i++) {\r\n      for (let j = 0; j < pos.length; j++) {\r\n        const row = pos[i];\r\n        const col = pos[j];\r\n        if (this.modules[row][col] != null) {\r\n          continue;\r\n        }\r\n        for (let r = -2; r <= 2; r++) {\r\n          for (let c = -2; c <= 2; c++) {\r\n            if (r === -2 || r === 2 || c === -2 || c === 2 || (r === 0 && c === 0)) {\r\n              this.modules[row + r][col + c] = true;\r\n            } else {\r\n              this.modules[row + r][col + c] = false;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setupTypeNumber(test) {\r\n    const bits = QRUtil.getBCHTypeNumber(this.typeNumber);\r\n    for (let i = 0; i < 18; i++) {\r\n      this.modules[Math.floor(i / 3)][(i % 3) + this.moduleCount - 8 - 3] = !test && ((bits >> i) & 1) === 1;\r\n    }\r\n    for (let i = 0; i < 18; i++) {\r\n      this.modules[(i % 3) + this.moduleCount - 8 - 3][Math.floor(i / 3)] = !test && ((bits >> i) & 1) === 1;\r\n    }\r\n  }\r\n\r\n  setupTypeInfo(test, maskPattern) {\r\n    const data = (this.errorCorrectLevel << 3) | maskPattern;\r\n    const bits = QRUtil.getBCHTypeInfo(data);\r\n    for (let i = 0; i < 15; i++) {\r\n      const mod = !test && ((bits >> i) & 1) === 1;\r\n      if (i < 6) {\r\n        this.modules[i][8] = mod;\r\n      } else if (i < 8) {\r\n        this.modules[i + 1][8] = mod;\r\n      } else {\r\n        this.modules[this.moduleCount - 15 + i][8] = mod;\r\n      }\r\n    }\r\n    for (let i = 0; i < 15; i++) {\r\n      const mod = !test && ((bits >> i) & 1) === 1;\r\n      if (i < 8) {\r\n        this.modules[8][this.moduleCount - i - 1] = mod;\r\n      } else if (i < 9) {\r\n        this.modules[8][15 - i - 1 + 1] = mod;\r\n      } else {\r\n        this.modules[8][15 - i - 1] = mod;\r\n      }\r\n    }\r\n    this.modules[this.moduleCount - 8][8] = !test;\r\n  }\r\n\r\n  mapData(data, maskPattern) {\r\n    let inc = -1;\r\n    let row = this.moduleCount - 1;\r\n    let bitIndex = 7;\r\n    let byteIndex = 0;\r\n    for (let col = this.moduleCount - 1; col > 0; col -= 2) {\r\n      if (col === 6) col--;\r\n      while (true) {\r\n        for (let c = 0; c < 2; c++) {\r\n          if (this.modules[row][col - c] == null) {\r\n            let dark = false;\r\n            if (byteIndex < data.length) {\r\n              dark = ((data[byteIndex] >>> bitIndex) & 1) === 1;\r\n            }\r\n            const mask = QRUtil.getMask(maskPattern, row, col - c);\r\n            if (mask) {\r\n              dark = !dark;\r\n            }\r\n            this.modules[row][col - c] = dark;\r\n            bitIndex--;\r\n            if (bitIndex === -1) {\r\n              byteIndex++;\r\n              bitIndex = 7;\r\n            }\r\n          }\r\n        }\r\n        row += inc;\r\n        if (row < 0 || this.moduleCount <= row) {\r\n          row -= inc;\r\n          inc = -inc;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  createData(typeNumber, errorCorrectLevel, dataList) {\r\n    const rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\r\n    const buffer = new QRBitBuffer();\r\n    for (let i = 0; i < dataList.length; i++) {\r\n      const data = dataList[i];\r\n      buffer.put(data.mode, 4);\r\n      buffer.put(data.getLength(), QRUtil.getLengthInBits(data.mode, typeNumber));\r\n      data.write(buffer);\r\n    }\r\n    let totalDataCount = 0;\r\n    for (let i = 0; i < rsBlocks.length; i++) {\r\n      totalDataCount += rsBlocks[i].dataCount;\r\n    }\r\n    if (buffer.getLengthInBits() > totalDataCount * 8) {\r\n      throw new Error('code length overflow. (' + buffer.getLengthInBits() + '>' + totalDataCount * 8 + ')');\r\n    }\r\n    if (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\r\n      buffer.put(0, 4);\r\n    }\r\n    while (buffer.getLengthInBits() % 8 !== 0) {\r\n      buffer.putBit(false);\r\n    }\r\n    while (true) {\r\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\r\n        break;\r\n      }\r\n      buffer.put(PAD0, 8);\r\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\r\n        break;\r\n      }\r\n      buffer.put(PAD1, 8);\r\n    }\r\n    return this.createBytes(buffer, rsBlocks);\r\n  }\r\n\r\n  createBytes(buffer, rsBlocks) {\r\n    let offset = 0;\r\n    let maxDcCount = 0;\r\n    let maxEcCount = 0;\r\n    const dcdata = new Array(rsBlocks.length);\r\n    const ecdata = new Array(rsBlocks.length);\r\n    for (let r = 0; r < rsBlocks.length; r++) {\r\n      const dcCount = rsBlocks[r].dataCount;\r\n      const ecCount = rsBlocks[r].totalCount - dcCount;\r\n      maxDcCount = Math.max(maxDcCount, dcCount);\r\n      maxEcCount = Math.max(maxEcCount, ecCount);\r\n      dcdata[r] = new Array(dcCount);\r\n      for (let i = 0; i < dcdata[r].length; i++) {\r\n        dcdata[r][i] = 0xff & buffer.buffer[i + offset];\r\n      }\r\n      offset += dcCount;\r\n      const rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\r\n      const rawPoly = new QRPolynomial(dcdata[r], rsPoly.getLength() - 1);\r\n      const modPoly = rawPoly.mod(rsPoly);\r\n      ecdata[r] = new Array(rsPoly.getLength() - 1);\r\n      for (let i = 0; i < ecdata[r].length; i++) {\r\n        const modIndex = i + modPoly.getLength() - ecdata[r].length;\r\n        ecdata[r][i] = modIndex >= 0 ? modPoly.get(modIndex) : 0;\r\n      }\r\n    }\r\n    let totalCodeCount = 0;\r\n    for (let i = 0; i < rsBlocks.length; i++) {\r\n      totalCodeCount += rsBlocks[i].totalCount;\r\n    }\r\n    const data = new Array(totalCodeCount);\r\n    let index = 0;\r\n    for (let i = 0; i < maxDcCount; i++) {\r\n      for (let r = 0; r < rsBlocks.length; r++) {\r\n        if (i < dcdata[r].length) {\r\n          data[index++] = dcdata[r][i];\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < maxEcCount; i++) {\r\n      for (let r = 0; r < rsBlocks.length; r++) {\r\n        if (i < ecdata[r].length) {\r\n          data[index++] = ecdata[r][i];\r\n        }\r\n      }\r\n    }\r\n    return data;\r\n  }\r\n}\r\n","export const QRCodeLimitLength = [\r\n  [17, 14, 11, 7],\r\n  [32, 26, 20, 14],\r\n  [53, 42, 32, 24],\r\n  [78, 62, 46, 34],\r\n  [106, 84, 60, 44],\r\n  [134, 106, 74, 58],\r\n  [154, 122, 86, 64],\r\n  [192, 152, 108, 84],\r\n  [230, 180, 130, 98],\r\n  [271, 213, 151, 119],\r\n  [321, 251, 177, 137],\r\n  [367, 287, 203, 155],\r\n  [425, 331, 241, 177],\r\n  [458, 362, 258, 194],\r\n  [520, 412, 292, 220],\r\n  [586, 450, 322, 250],\r\n  [644, 504, 364, 280],\r\n  [718, 560, 394, 310],\r\n  [792, 624, 442, 338],\r\n  [858, 666, 482, 382],\r\n  [929, 711, 509, 403],\r\n  [1003, 779, 565, 439],\r\n  [1091, 857, 611, 461],\r\n  [1171, 911, 661, 511],\r\n  [1273, 997, 715, 535],\r\n  [1367, 1059, 751, 593],\r\n  [1465, 1125, 805, 625],\r\n  [1528, 1190, 868, 658],\r\n  [1628, 1264, 908, 698],\r\n  [1732, 1370, 982, 742],\r\n  [1840, 1452, 1030, 790],\r\n  [1952, 1538, 1112, 842],\r\n  [2068, 1628, 1168, 898],\r\n  [2188, 1722, 1228, 958],\r\n  [2303, 1809, 1283, 983],\r\n  [2431, 1911, 1351, 1051],\r\n  [2563, 1989, 1423, 1093],\r\n  [2699, 2099, 1499, 1139],\r\n  [2809, 2213, 1579, 1219],\r\n  [2953, 2331, 1663, 1273],\r\n];\r\n","export const getProp = (object, keys, defaultVal = undefined) => {\r\n  keys = Array.isArray(keys) ? keys : keys.split('.');\r\n  object = object[keys[0]];\r\n  if (object && keys.length > 1) {\r\n    return getProp(object, keys.slice(1));\r\n  }\r\n  return object === undefined ? defaultVal : object;\r\n};\r\n\r\nexport const round = (val: number, precision = 1e1) => {\r\n  return Math.round(val * precision) / precision;\r\n};\r\n\r\nexport const neighborOffsets = [\r\n  [-1, 0],\r\n  [0, -1],\r\n  [1, 0],\r\n  [0, 1],\r\n];\r\n\r\nexport const contour = [\r\n  [\r\n    [0, 0],\r\n    [0, 1],\r\n  ],\r\n  [\r\n    [0, 0],\r\n    [1, 0],\r\n  ],\r\n  [\r\n    [1, 0],\r\n    [1, 1],\r\n  ],\r\n  [\r\n    [0, 1],\r\n    [1, 1],\r\n  ],\r\n];\r\n\r\nexport const getUTF8Length = (content) => {\r\n  const result = encodeURI(content)\r\n    .toString()\r\n    .replace(/%[0-9a-fA-F]{2}/g, 'a');\r\n  return result.length + (result.length !== content ? 3 : 0);\r\n};\r\n","import { QRCodeModel } from './QRCodeModel';\r\nimport { QRErrorCorrectLevel } from './QRErrorCorrectLevel';\r\nimport { QRCodeLimitLength } from './QRCodeLimitLength';\r\nimport { getUTF8Length } from './utils';\r\n\r\ntype QRCodeOptions = {\r\n  ecl: 'L' | 'M' | 'Q' | 'H';\r\n  content: string;\r\n};\r\n\r\nexport class QRCode {\r\n  options: QRCodeOptions = {\r\n    ecl: 'M',\r\n    content: '',\r\n  };\r\n\r\n  private readonly qrcode!: QRCodeModel;\r\n\r\n  constructor(options: Partial<QRCodeOptions>) {\r\n    for (const i in options) {\r\n      this.options[i] = options[i];\r\n    }\r\n\r\n    if (this.options.content.length === 0) {\r\n      throw new Error(\"Expected 'content' to be non-empty!\");\r\n    }\r\n\r\n    const content = this.options.content;\r\n    const type = this.getTypeNumber(content, this.options.ecl);\r\n    const ecl = this.getErrorCorrectLevel(this.options.ecl);\r\n    this.qrcode = new QRCodeModel(type, ecl);\r\n    this.qrcode.addData(content);\r\n    this.qrcode.make();\r\n  }\r\n\r\n  private getErrorCorrectLevel(ecl) {\r\n    const result = QRErrorCorrectLevel[ecl];\r\n\r\n    if (result == undefined) {\r\n      throw new Error('Unknwon error correction level: ' + ecl);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  private getTypeNumber(content, ecl) {\r\n    const length = getUTF8Length(content);\r\n\r\n    let type = 1;\r\n    let limit = 0;\r\n    let i = 0;\r\n    const len = QRCodeLimitLength.length;\r\n    for (; i <= len; i++) {\r\n      const table = QRCodeLimitLength[i];\r\n      if (!table) {\r\n        throw new Error('Content too long: expected ' + limit + ' but got ' + length);\r\n      }\r\n\r\n      switch (ecl) {\r\n        case 'L':\r\n          limit = table[0];\r\n          break;\r\n\r\n        case 'M':\r\n          limit = table[1];\r\n          break;\r\n\r\n        case 'Q':\r\n          limit = table[2];\r\n          break;\r\n\r\n        case 'H':\r\n          limit = table[3];\r\n          break;\r\n\r\n        default:\r\n          throw new Error('Unknwon error correction level: ' + ecl);\r\n      }\r\n\r\n      if (length <= limit) {\r\n        break;\r\n      }\r\n\r\n      type++;\r\n    }\r\n\r\n    if (type > QRCodeLimitLength.length) {\r\n      throw new Error('Content too long');\r\n    }\r\n\r\n    return type;\r\n  }\r\n\r\n  emptyCenter(emptySize: number, emptySizeHeight?: number) {\r\n    const { size } = this;\r\n\r\n    emptySizeHeight = emptySizeHeight || emptySize;\r\n\r\n    const halfSize = size / 2;\r\n    const halfEmptySize = emptySize / 2;\r\n    const halfEmptySizeHeight = emptySizeHeight / 2;\r\n\r\n    for (let y = 0; y < size; y++) {\r\n      for (let x = 0; x < size; x++) {\r\n        if (\r\n          y >= halfSize - halfEmptySizeHeight &&\r\n          y < halfSize + halfEmptySizeHeight &&\r\n          x >= halfSize - halfEmptySize &&\r\n          x < halfSize + halfEmptySize\r\n        ) {\r\n          this.matrix[y][x] = false;\r\n        }\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  get matrix() {\r\n    return this.qrcode.modules;\r\n  }\r\n\r\n  get size() {\r\n    return this.qrcode.moduleCount;\r\n  }\r\n}\r\n","import { getProp, round, neighborOffsets, contour } from './utils';\r\nimport { QRCode } from './QRCode';\r\n\r\ntype QRSvgOptions = {\r\n  size: number;\r\n  radiusFactor: number;\r\n  cornerBlockRadiusFactor?: number;\r\n  roundOuterCorners: boolean;\r\n  roundInnerCorners: boolean;\r\n  cornerBlocksAsCircles: boolean;\r\n  fill: string;\r\n  preContent?: string | ((QRSvg) => string);\r\n  postContent?: string | ((QRSvg) => string);\r\n};\r\n\r\ntype Pride = 1 | 0;\r\n\r\ntype Cell = {\r\n  pride: Pride;\r\n  x: number;\r\n  y: number;\r\n  blockId?: string;\r\n  isCornerBlock: boolean;\r\n};\r\n\r\ntype LineSegment = {\r\n  processed: boolean;\r\n  p1: { x: number; y: number };\r\n  p2: { x: number; y: number };\r\n  cell: Cell;\r\n  cr: number;\r\n};\r\n\r\ntype LineSegmentsWithCrops = LineSegment[] & { crops?: LineSegment[][] };\r\n\r\nconst findNeighbors = (matrix: Cell[][], cell: Cell, pride: Pride, expectCells: Cell[] = []) => {\r\n  expectCells.push(cell);\r\n\r\n  for (const offset of neighborOffsets) {\r\n    const neighborCoord = { x: cell.x + offset[0], y: cell.y + offset[1] };\r\n\r\n    if (!expectCells.find((i) => i.x === neighborCoord.x && i.y === neighborCoord.y)) {\r\n      const neighborCell = getProp(matrix, [neighborCoord.y, neighborCoord.x]);\r\n\r\n      if (neighborCell && neighborCell.pride === pride) {\r\n        const pride = neighborCell.pride;\r\n        findNeighbors(matrix, neighborCell, pride, expectCells);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport class QRSvg {\r\n  private options: QRSvgOptions = {\r\n    size: 0,\r\n    radiusFactor: 0.75,\r\n    roundOuterCorners: true,\r\n    roundInnerCorners: true,\r\n    cornerBlocksAsCircles: false,\r\n    fill: 'currentColor',\r\n  };\r\n\r\n  private matrix!: Cell[][];\r\n\r\n  paths: string[] = [];\r\n\r\n  private readonly matrixSize!: number;\r\n\r\n  private lines: Record<string, LineSegmentsWithCrops> = {};\r\n\r\n  private lastUniqId = 0;\r\n\r\n  readonly pointSize!: number;\r\n\r\n  constructor(qrCode: QRCode, options: Partial<QRSvgOptions>) {\r\n    for (const i in options) {\r\n      this.options[i] = options[i];\r\n    }\r\n\r\n    if (this.options.cornerBlockRadiusFactor === undefined) {\r\n      this.options.cornerBlockRadiusFactor = this.options.radiusFactor;\r\n    }\r\n\r\n    if (!(this.options.size > 0)) {\r\n      throw new Error(\"Expected 'size' value to be higher than zero!\");\r\n    }\r\n\r\n    this.matrixSize = qrCode.size;\r\n    this.pointSize = this.options.size / this.matrixSize;\r\n\r\n    this.matrix = (() => {\r\n      const result: Cell[][] = [];\r\n      qrCode.matrix.forEach((row, rowIdx) => {\r\n        result[rowIdx] = [];\r\n        row.forEach((val, idx) => {\r\n          result[rowIdx][idx] = {\r\n            pride: val ? 1 : 0,\r\n            x: idx,\r\n            y: rowIdx,\r\n            blockId: undefined,\r\n            isCornerBlock: false,\r\n          } as Cell;\r\n        });\r\n      });\r\n      return result;\r\n    })();\r\n\r\n    this.detectBlocks();\r\n    this.detectLines();\r\n    this.generatePaths();\r\n  }\r\n\r\n  private detectBlocks() {\r\n    const { matrixSize, matrix } = this;\r\n\r\n    for (let y = 0; y < matrixSize; y++) {\r\n      for (let x = 0; x < matrixSize; x++) {\r\n        const currCell = matrix[y][x];\r\n        if (currCell.blockId === undefined && currCell.pride === 1) {\r\n          const cells: Cell[] = [];\r\n          findNeighbors(matrix, currCell, 1, cells);\r\n          const blockId = this.getUniqId();\r\n          cells.forEach((cell) => {\r\n            const { x, y } = cell;\r\n            cell.blockId = blockId;\r\n\r\n            if ((x < 8 && y < 8) || (x > this.matrixSize - 8 && y < 8) || (x < 8 && y > this.matrixSize - 8)) {\r\n              cell.isCornerBlock = true;\r\n            }\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private detectLines() {\r\n    const { lines, matrixSize, matrix } = this;\r\n\r\n    const pathRadius = (this.pointSize / 2) * Math.min(this.options.radiusFactor, 10);\r\n    const cornerBlockPathRadius = (this.pointSize / 2) * Math.min(this.options.cornerBlockRadiusFactor as number, 10);\r\n\r\n    for (let y = 0; y < matrixSize; y++) {\r\n      for (let x = 0; x < matrixSize; x++) {\r\n        const cell = matrix[y][x];\r\n        if (cell.blockId === undefined) {\r\n          continue;\r\n        }\r\n\r\n        if (cell.isCornerBlock && this.options.cornerBlocksAsCircles) {\r\n          continue;\r\n        }\r\n\r\n        neighborOffsets.forEach((offset, idx) => {\r\n          const neighborCell = getProp(matrix, [y + offset[0], x + offset[1]]);\r\n          if (!neighborCell || neighborCell.blockId !== cell.blockId) {\r\n            if (cell.blockId) {\r\n              lines[cell.blockId] = lines[cell.blockId] || [];\r\n              lines[cell.blockId].push({\r\n                processed: false,\r\n                p1: { y: y + contour[idx][0][0], x: x + contour[idx][0][1] },\r\n                p2: { y: y + contour[idx][1][0], x: x + contour[idx][1][1] },\r\n                cell,\r\n                cr: cell.isCornerBlock ? cornerBlockPathRadius : pathRadius,\r\n              });\r\n            }\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    Object.keys(lines).forEach((key) => {\r\n      const line = lines[key];\r\n\r\n      const proc = (py, px, result, oCell) => {\r\n        const nextSegs = line\r\n          .filter((seg) => {\r\n            if (!seg.processed) {\r\n              if ((seg.p1.y === py && seg.p1.x === px) || (seg.p2.y === py && seg.p2.x === px)) {\r\n                return true;\r\n              }\r\n            }\r\n            return false;\r\n          })\r\n          .sort((a, b) => {\r\n            if (a.cell === oCell) {\r\n              return -1;\r\n            }\r\n            return 1;\r\n          });\r\n\r\n        const nextSeg = nextSegs[0];\r\n\r\n        if (nextSeg) {\r\n          nextSeg.processed = true;\r\n          let resultSeg;\r\n          if (nextSeg.p1.y === py && nextSeg.p1.x === px) {\r\n            resultSeg = { p1: nextSeg.p1, p2: nextSeg.p2, cr: nextSeg.cr };\r\n          } else if (nextSeg.p2.y === py && nextSeg.p2.x === px) {\r\n            resultSeg = { p1: nextSeg.p2, p2: nextSeg.p1, cr: nextSeg.cr };\r\n          }\r\n          result.push(resultSeg);\r\n          proc(resultSeg.p2.y, resultSeg.p2.x, result, nextSeg.cell);\r\n        }\r\n      };\r\n      line[0].processed = true;\r\n      const result: LineSegmentsWithCrops = [line[0]];\r\n      proc(line[0].p2.y, line[0].p2.x, result, line[0].cell);\r\n      lines[key] = result;\r\n      lines[key].crops = [];\r\n\r\n      let checkCrops = true;\r\n      while (checkCrops) {\r\n        const notProcessedSeg = line.find((i) => !i.processed);\r\n        if (notProcessedSeg) {\r\n          notProcessedSeg.processed = true;\r\n          const cropResult = [notProcessedSeg];\r\n          proc(notProcessedSeg.p2.y, notProcessedSeg.p2.x, cropResult, notProcessedSeg.cell);\r\n          cropResult.reverse();\r\n          cropResult.map((seg) => {\r\n            const op2 = seg.p2;\r\n            seg.p2 = seg.p1;\r\n            seg.p1 = op2;\r\n            return seg;\r\n          });\r\n          lines[key]?.crops?.push(cropResult);\r\n        } else {\r\n          checkCrops = false;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private getDir(seg) {\r\n    if (seg.p1.x === seg.p2.x) {\r\n      if (seg.p1.y > seg.p2.y) {\r\n        return 'sn';\r\n      }\r\n      return 'ns';\r\n    }\r\n    if (seg.p1.y === seg.p2.y) {\r\n      if (seg.p1.x > seg.p2.x) {\r\n        return 'ew';\r\n      }\r\n      return 'we';\r\n    }\r\n  }\r\n\r\n  private getSubPath(seg, prevSeg, roundOuterCorners, roundInnerCorners) {\r\n    const { pointSize } = this;\r\n\r\n    let {\r\n      p1: { x, y },\r\n      cr,\r\n    } = seg;\r\n\r\n    x = x * pointSize;\r\n    y = y * pointSize;\r\n\r\n    const xmcr = round(x - cr);\r\n    const xpcr = round(x + cr);\r\n\r\n    const ymcr = round(y - cr);\r\n    const ypcr = round(y + cr);\r\n\r\n    x = round(x);\r\n    y = round(y);\r\n\r\n    const segDir = this.getDir(seg);\r\n    const prevSegDir = this.getDir(prevSeg);\r\n\r\n    let path = '';\r\n    if (cr && roundOuterCorners && prevSegDir === 'we' && segDir === 'ns') {\r\n      path += `L${xmcr} ${y} `;\r\n      path += `Q${x} ${y} ${x} ${ypcr}`;\r\n    } else if (cr && roundOuterCorners && prevSegDir === 'ns' && segDir === 'ew') {\r\n      path += `L${x} ${ymcr} `;\r\n      path += `Q${x} ${y} ${xmcr} ${y}`;\r\n    } else if (cr && roundOuterCorners && prevSegDir === 'ew' && segDir === 'sn') {\r\n      path += `L${xpcr} ${y} `;\r\n      path += `Q${x} ${y} ${x} ${ymcr}`;\r\n    } else if (cr && roundOuterCorners && prevSegDir === 'sn' && segDir === 'we') {\r\n      path += `L${x} ${ypcr} `;\r\n      path += `Q${x} ${y} ${xpcr} ${y}`;\r\n    } else if (cr && roundInnerCorners && prevSegDir === 'sn' && segDir === 'ew') {\r\n      path += `L${x} ${ypcr} `;\r\n      path += `Q${x} ${y} ${xmcr} ${y}`;\r\n    } else if (cr && roundInnerCorners && prevSegDir === 'ew' && segDir === 'ns') {\r\n      path += `L${xpcr} ${y} `;\r\n      path += `Q${x} ${y} ${x} ${ypcr}`;\r\n    } else if (cr && roundInnerCorners && prevSegDir === 'ns' && segDir === 'we') {\r\n      path += `L${x} ${ymcr} `;\r\n      path += `Q${x} ${y} ${xpcr} ${y}`;\r\n    } else if (cr && roundInnerCorners && prevSegDir === 'we' && segDir === 'sn') {\r\n      path += `L${xmcr} ${y} `;\r\n      path += `Q${x} ${y} ${x} ${ymcr}`;\r\n    } else {\r\n      path += `L${x} ${y} `;\r\n    }\r\n    return path;\r\n  }\r\n\r\n  private getUniqId() {\r\n    return String(this.lastUniqId++);\r\n  }\r\n\r\n  private generatePaths() {\r\n    const {\r\n      pointSize,\r\n      options: { roundOuterCorners, roundInnerCorners, cornerBlocksAsCircles },\r\n    } = this;\r\n\r\n    const { lines } = this;\r\n    const paths: string[] = [];\r\n\r\n    Object.keys(lines).forEach((key) => {\r\n      let path = '';\r\n      for (const [lineIdx, line] of [lines[key], ...(lines[key].crops as LineSegment[][])].entries()) {\r\n        for (const [segIdx, seg] of line.entries()) {\r\n          let {\r\n            p1: { x, y },\r\n            cr,\r\n          } = seg;\r\n\r\n          x = x * pointSize;\r\n          y = y * pointSize;\r\n\r\n          const xpcr = round(x + cr);\r\n          const ypcr = round(y + cr);\r\n\r\n          x = round(x);\r\n          y = round(y);\r\n\r\n          const prevSeg = line[segIdx - 1] || line[line.length - 1];\r\n          const nextSeg = line[segIdx + 1] || line[0];\r\n\r\n          const segDir = this.getDir(seg);\r\n          const prevSegDir = this.getDir(prevSeg);\r\n\r\n          if (segIdx === 0) {\r\n            if (roundOuterCorners) {\r\n              if (lineIdx === 0) {\r\n                path += `M${xpcr} ${y} `;\r\n              } else {\r\n                path += `M${x} ${ypcr} `;\r\n              }\r\n            } else {\r\n              path += `M${x} ${y} `;\r\n            }\r\n          } else if (segIdx === line.length - 1) {\r\n            path += this.getSubPath(seg, prevSeg, roundOuterCorners, roundInnerCorners);\r\n            path += this.getSubPath(nextSeg, seg, roundOuterCorners, roundInnerCorners);\r\n            path += 'Z';\r\n          } else if (prevSegDir !== segDir) {\r\n            path += this.getSubPath(seg, prevSeg, roundOuterCorners, roundInnerCorners);\r\n          }\r\n        }\r\n      }\r\n      paths.push(`<path d=\"${path}\"/>`);\r\n    });\r\n\r\n    if (cornerBlocksAsCircles) {\r\n      const offsetSize = this.pointSize * this.matrixSize - this.pointSize * 7;\r\n      [\r\n        [0, 0],\r\n        [offsetSize, 0],\r\n        [0, offsetSize],\r\n      ].forEach(([ox, oy]) => {\r\n        const centerX = round((this.pointSize * 7) / 2 + ox);\r\n        const centerY = round((this.pointSize * 7) / 2 + oy);\r\n\r\n        let outerRadius = round((this.pointSize * 7) / 2);\r\n        const innerRadius = round((this.pointSize * 7) / 2 - this.pointSize);\r\n\r\n        // Big circle\r\n        paths.push(`<path d=\"\\\r\nM ${centerX} ${centerY - outerRadius} \\\r\nA ${outerRadius} ${outerRadius} 0 1 0 ${centerX} ${round(centerY + outerRadius)} \\\r\nA ${outerRadius} ${outerRadius} 0 1 0 ${centerX} ${round(centerY - outerRadius)} \\\r\nZ \\\r\nM ${centerX} ${centerY - innerRadius} \\\r\nA ${innerRadius} ${innerRadius} 0 1 1 ${centerX} ${round(centerY + innerRadius)} \\\r\nA ${innerRadius} ${innerRadius} 0 1 1 ${centerX} ${round(centerY - innerRadius)} \\\r\nZ\" />`);\r\n\r\n        // Small circle\r\n        outerRadius = round((this.pointSize * 7) / 2 - this.pointSize * 2);\r\n        paths.push(`<path d=\"\\\r\nM ${centerX} ${centerY - outerRadius} \\\r\nA ${outerRadius} ${outerRadius} 0 1 0 ${centerX} ${round(centerY + outerRadius)} \\\r\nA ${outerRadius} ${outerRadius} 0 1 0 ${centerX} ${round(centerY - outerRadius)} \\\r\nZ\" />`);\r\n      });\r\n    }\r\n\r\n    this.paths = paths;\r\n  }\r\n\r\n  private svgAdditionalContent(additionalContent): string {\r\n    if (typeof additionalContent === 'function') {\r\n      return additionalContent(this);\r\n    }\r\n\r\n    if (typeof additionalContent === 'string') {\r\n      return additionalContent;\r\n    }\r\n\r\n    return additionalContent || '';\r\n  }\r\n\r\n  get svg() {\r\n    const { size, fill } = this.options;\r\n\r\n    return `\\\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${size} ${size}\" width=\"${size}\" height=\"${size}\" fill=\"${fill}\">\r\n${this.svgAdditionalContent(this.options.preContent)}\r\n${this.paths.join('\\n')}\r\n${this.svgAdditionalContent(this.options.postContent)}\r\n</svg>`;\r\n  }\r\n}\r\n"],"names":["QR8bitByte","data","mode","parsedData","this","i","l","length","code","charCodeAt","push","Array","prototype","concat","apply","unshift","getLength","write","buffer","put","QRErrorCorrectLevel","L","M","Q","H","QRRSBlock","totalCount","dataCount","getRSBlocks","typeNumber","errorCorrectLevel","rsBlock","getRsBlockTable","undefined","Error","list","count","j","RS_BLOCK_TABLE","QRBitBuffer","get","index","bufIndex","Math","floor","num","putBit","getLengthInBits","bit","EXP_TABLE","LOG_TABLE","glog","n","gexp","QRPolynomial","shift","offset","multiply","e","QRMath","mod","ratio","PATTERN_POSITION_TABLE","getBCHDigit","digit","getMask","maskPattern","getErrorCorrectPolynomial","errorCorrectLength","a","type","getLostPoint","qrCode","moduleCount","getModuleCount","lostPoint","row","col","sameCount","dark","isDark","r","c","darkCount","abs","QRCodeModel","modules","dataCache","dataList","addData","newData","make","makeImpl","getBestMaskPattern","test","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","minLostPoint","pattern","QRUtil","createMovieClip","target_mc","instance_name","depth","qr_mc","createEmptyMovieClip","y","x","beginFill","moveTo","lineTo","endFill","pos","bits","d","inc","bitIndex","byteIndex","rsBlocks","totalDataCount","createBytes","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","ecCount","max","rsPoly","modPoly","modIndex","totalCodeCount","QRCodeLimitLength","getProp","object","keys","defaultVal","isArray","split","slice","round","val","precision","neighborOffsets","contour","QRCode","options","ecl","content","qrcode","getTypeNumber","getErrorCorrectLevel","result","encodeURI","toString","replace","getUTF8Length","limit","len","table","emptyCenter","emptySize","emptySizeHeight","size","halfSize","halfEmptySize","halfEmptySizeHeight","matrix","findNeighbors","cell","pride","expectCells","neighborCoord","find","neighborCell","QRSvg","radiusFactor","roundOuterCorners","roundInnerCorners","cornerBlocksAsCircles","fill","paths","matrixSize","lines","lastUniqId","pointSize","cornerBlockRadiusFactor","forEach","rowIdx","idx","blockId","isCornerBlock","detectBlocks","detectLines","generatePaths","currCell","cells","_this","getUniqId","pathRadius","min","cornerBlockPathRadius","_this2","processed","p1","p2","cr","Object","key","line","proc","py","px","oCell","resultSeg","nextSeg","filter","seg","sort","b","crops","checkCrops","notProcessedSeg","cropResult","reverse","map","op2","getDir","getSubPath","prevSeg","xmcr","xpcr","ymcr","ypcr","segDir","prevSegDir","path","String","entries","lineIdx","segIdx","_this3","offsetSize","oy","centerX","centerY","outerRadius","innerRadius","svgAdditionalContent","additionalContent","preContent","join","postContent"],"mappings":"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I,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,IAAK,IAAK,EAAG,IAAK,KACtB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,GAAI,IAAK,KACvB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,EAAG,IAAK,KACtB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,EAAG,IAAK,IAAK,GAAI,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,KACV,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IACrB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,GAAI,GAAI,EAAG,GAAI,IACpB,CAAC,GAAI,IAAK,IAAK,EAAG,IAAK,KACvB,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"}